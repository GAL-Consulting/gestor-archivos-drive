<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gestor Documental</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: #2c3e50;
      color: white;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    nav button {
      margin: 0 5px;
      padding: 8px 12px;
      border: none;
      cursor: pointer;
      border-radius: 4px;
      background: #34495e;
      color: white;
    }

    nav button.active {
      background: #1abc9c;
    }

    main {
      flex: 1;
      display: none; /* oculto por defecto */
      height: calc(100vh - 50px);
    }

    /* Layout Registro (placeholder simplificado) */
    #registro {
      display: grid;
      grid-template-columns: 25% 50% 25%;
      gap: 10px;
      padding: 10px;
      box-sizing: border-box;
    }
    #registro > div {
      border: 1px solid #ccc;
      padding: 10px;
    }

    /* Layout Consultas (Diseño B) */
    #consultas {
      display: grid;
      grid-template-columns: 30% 70%;
      gap: 10px;
      padding: 10px;
      box-sizing: border-box;
    }
    #consultas .left {
      border: 1px solid #ccc;
      padding: 10px;
      overflow-y: auto;
    }
    #consultas .right {
      display: grid;
      grid-template-rows: 40% 60%;
      gap: 10px;
    }
    #consultas .right > div {
      border: 1px solid #ccc;
      padding: 10px;
      overflow: auto;
    }
  </style>
</head>
<body>
  <header>
    <div><strong>Gestor Documental</strong></div>
    <nav>
      <button id="btnRegistro" class="active">Registro</button>
      <button id="btnConsultas">Consultas</button>
      <button id="login">Login con Google</button>
    </nav>
  </header>

  <!-- Sección Registro -->
  <main id="registro">
    <div>📂 Carpetas + Archivos</div>
    <div>📑 Visor de archivo</div>
    <div>📝 Formulario de registro</div>
  </main>

  <!-- Sección Consultas -->
  <main id="consultas">
    <div class="left">
      🔍 Búsqueda + Lista de resultados
    </div>
    <div class="right">
      <div>📋 Detalle / Edición del registro</div>
      <div>📑 Visor de archivo</div>
    </div>
  </main>

  <!-- Google API -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <script>
    const CLIENT_ID = "TU_CLIENT_ID";
    const SCOPES = "https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/spreadsheets";

    let tokenClient;
    let gapiInited = false;
    let gisInited = false;

    function gapiLoaded() {
      gapi.load('client', initializeGapiClient);
    }

    async function initializeGapiClient() {
      await gapi.client.init({
        discoveryDocs: [
          "https://www.googleapis.com/discovery/v1/apis/drive/v3/rest",
          "https://sheets.googleapis.com/$discovery/rest?version=v4"
        ]
      });
      gapiInited = true;
      maybeEnableLogin();
    }

    function gisLoaded() {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: ''
      });
      gisInited = true;
      maybeEnableLogin();
    }

    function maybeEnableLogin() {
      if (gapiInited && gisInited) {
        document.getElementById("login").disabled = false;
      }
    }

    document.getElementById("login").onclick = () => {
      tokenClient.callback = async (resp) => {
        if (resp.error) { console.error(resp); return; }
        gapi.client.setToken({ access_token: resp.access_token });

        // Ocultar botón login
        document.getElementById("login").style.display = "none";

        // Mostrar sección por defecto
        mostrarSeccion("registro");
      };
      tokenClient.requestAccessToken({ prompt: 'consent' });
    };

    // Alternar entre secciones
    function mostrarSeccion(id) {
      document.querySelectorAll("main").forEach(m => m.style.display = "none");
      document.getElementById(id).style.display = "grid";

      document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
      if (id === "registro") document.getElementById("btnRegistro").classList.add("active");
      if (id === "consultas") document.getElementById("btnConsultas").classList.add("active");
    }

    document.getElementById("btnRegistro").onclick = () => mostrarSeccion("registro");
    document.getElementById("btnConsultas").onclick = () => mostrarSeccion("consultas");

    window.onload = () => {
      gapiLoaded();
      gisLoaded();
    };
  </script>
</body>
</html>
